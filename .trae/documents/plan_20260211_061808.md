我将按照以下计划实现多对话管理和新助手功能：

### 1. 多对话会话管理 (后端)

1. **数据库变更**：

   * 创建 `ChatSession` 实体和 `chat_session` 表，包含 `id`, `userId`, `assistantType`, `name` (会话名称), `createTime`, `updateTime`。

   * 更新 `ChatMessage` 实体，将 `memoryId` 字段的含义明确为 `sessionId`，或者直接重构为使用 `sessionId` 关联。目前 `ChatMessage` 已有 `memoryId`，我们可以复用它作为会话 ID (Session ID)。
2. **后端服务实现**：

   * 创建 `ChatSessionService` 和 `ChatSessionMapper`，提供创建会话、删除会话、重命名会话、获取用户会话列表的功能。

   * 创建 `ChatSessionController`，暴露 REST API：

     * `POST /session/create`: 创建新会话

     * `DELETE /session/delete`: 删除会话

     * `POST /session/rename`: 重命名

     * `GET /session/list`: 获取某助手类型的会话列表

   * **重要调整**：更新 `AiController` 和 `ChatHistoryService`。目前 `chatWithSSE` 可能接收 `memoryId`。我们需要确保前端在发起聊天时传递的是选中的 `sessionId`。消息保存时，将关联到这个 `sessionId`。

### 2. 新增 AI 助手 (后端)

1. **Prompt 准备**：

   * 创建 `system-prompt-medical.txt`: 定义医疗助手的人设（免责声明、专业性、同理心）。

   * 创建 `system-prompt-college.txt`: 定义升学规划助手的人设（客观性、多维度分析）。
2. **Service 工厂更新**：

   * 在 `AiCodeHelperServiceFactory` 中注册 `AiMedicalService` 和 `AiCollegePlanningService` Bean。

   * 这些服务将复用现有的 `ChatModel` 和 `ChatMemory` 配置，但加载不同的 System Prompt。
3. **API 扩展**：

   * 在 `AiController` 中添加 `/ai/medical/chat` 和 `/ai/college/chat` 接口（或者重构为通用的 `/ai/chat/{type}` 接口，目前项目似乎是分开的 endpoints）。

### 3. 前端实现 (Vue.js)

1. **API 层更新** (`chatApi.js`, `sessionApi.js`):

   * 添加调用 Session 相关接口的方法。

   * 更新 `chatWithSSE` 以支持新的助手类型。
2. **状态管理**：

   * 在 `App.vue` 中增加 `currentSessionId` 状态。

   * 当切换 `currentMode` (助手类型) 时，自动加载该类型的会话列表。
3. **UI 组件开发**：

   * **侧边栏升级**：在 `Sidebar` 中添加“会话列表”区域。

     * 显示当前助手的历史会话。

     * 提供“+ 新建会话”按钮。

     * 每个会话项提供删除/重命名操作（图标或右键菜单）。

   * **首页卡片**：增加“医疗助手”和“升学规划助手”的卡片，配置相应的主题色和图标。

   * **聊天区域**：

     * 当选中某个会话时，加载该 `sessionId` 的历史记录。

     * 当创建新会话时，清空当前聊天视图，准备新的上下文。

### 4. 验证与测试

1. **功能验证**：

   * 测试创建/删除/切换会话，确认聊天记录互不干扰。

   * 测试新助手的回答是否符合人设。

   * 测试页面刷新后是否能恢复之前的会话状态。
2. **UI/UX 验证**：

   * 检查新卡片的主题色是否协调。

   * 检查侧边栏会话列表的交互体验（滚动、点击反馈）。

### 执行顺序

1. 后端：创建 Session 实体与 API。
2. 后端：实现新助手的 Service 与 Controller。
3. 前端：API 封装与 Store/State 调整。
4. 前端：UI 布局调整（侧边栏、首页）。
5. 联调与优化。

